{
  "image": "${localEnv:IMAGE:mcr.microsoft.com/devcontainers/base:debian}",
 
  "features": {
    "ghcr.io/ptab/devcontainer-features/helix-language-server-proxy": {},
    "./features/bash-language-server": {},
    "./features/json-language-server": {},
    "./features/yaml-language-server": {},
    "./features/metals": {},
    "ghcr.io/devcontainers-extra/features/ruff": {} 
  },
  
  "runArgs": [
    "-v", "${localEnv:SSH_AUTH_SOCK}:/run/host-services/ssh-auth.sock"
  ],

  "containerUser": "vscode",
  "remoteUser": "vscode",
  
  "workspaceMount": "source=${localWorkspaceFolder},target=${localWorkspaceFolder},type=bind",
  "workspaceFolder": "${localWorkspaceFolder}",

  "containerEnv": {
    "SSH_AUTH_SOCK": "/run/host-services/ssh-auth.sock"
  },

  "remoteEnv": {
    "SSH_AUTH_SOCK": "/run/host-services/ssh-auth.sock"
  },
  
  "onCreateCommand": {
    "add-github-to-known-hosts": "mkdir -p ~/.ssh && curl --silent https://api.github.com/meta | jq --raw-output '\"github.com \"+.ssh_keys[]' >> ~/.ssh/known_hosts",
    "socket-permissions": "sudo chown -R $(id -u) /run/host-services/ssh-auth.sock",
  }
}
